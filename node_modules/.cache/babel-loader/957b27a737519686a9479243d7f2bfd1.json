{"remainingRequest":"/Users/stavros/Documents/web/scripta/scripta/node_modules/babel-loader/lib/index.js!/Users/stavros/Documents/web/scripta/scripta/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/stavros/Documents/web/scripta/scripta/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/stavros/Documents/web/scripta/scripta/src/components/EditAttachments.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/stavros/Documents/web/scripta/scripta/src/components/EditAttachments.vue","mtime":1614357400000},{"path":"/Users/stavros/Documents/web/scripta/scripta/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/stavros/Documents/web/scripta/scripta/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/stavros/Documents/web/scripta/scripta/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/stavros/Documents/web/scripta/scripta/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgVmlld0ltYWdlIGZyb20gJy4vVmlld0ltYWdlJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdFZGl0QXR0YWNobWVudHMnLAogIGNvbXBvbmVudHM6IHsKICAgIFZpZXdJbWFnZTogVmlld0ltYWdlCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbm90ZUF0dGFjaG1lbnRzOiBbXSwKICAgICAgbmV3Tm90ZUF0dGFjaG1lbnRzOiBbXSwKICAgICAgdG90YWxTaXplOiAwLAogICAgICB2aWV3SW1hZ2U6IGZhbHNlLAogICAgICBzZWxlY3RlZEF0dGFjaG1lbnQ6IFtdCiAgICB9OwogIH0sCiAgcHJvcHM6IFsnYXR0YWNobWVudHMnLCAnbm90ZURhdGEnLCAnbm9BdHRhY2htZW50cyddLAogIHdhdGNoOiB7CiAgICBub3RlQXR0YWNobWVudHM6IGZ1bmN0aW9uIG5vdGVBdHRhY2htZW50cyhuZXdWYWwpIHsKICAgICAgdGhpcy5ub3RlQXR0YWNobWVudHMgPSBuZXdWYWw7CiAgICB9LAogICAgbmV3Tm90ZUF0dGFjaG1lbnRzOiBmdW5jdGlvbiBuZXdOb3RlQXR0YWNobWVudHMobmV3VmFsKSB7CiAgICAgIHRoaXMubmV3Tm90ZUF0dGFjaG1lbnRzID0gbmV3VmFsOwogICAgfSwKICAgIGF0dGFjaG1lbnRzOiBmdW5jdGlvbiBhdHRhY2htZW50cyhuZXdWYWwpIHsKICAgICAgdGhpcy5hdHRhY2htZW50cyA9IG5ld1ZhbDsKICAgICAgdGhpcy5zaG93QXR0YWNobWVudHMoKTsKICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB0aGlzLnNob3dBdHRhY2htZW50cygpOwogIH0sCiAgbWV0aG9kczogewogICAgc2hvd0F0dGFjaG1lbnRzOiBmdW5jdGlvbiBzaG93QXR0YWNobWVudHMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3R1cm4gYXR0YWNobWVudCBkYXRhIGludG8gdmlzaWJsZSBmb3JtYXQKICAgICAgdGhpcy5ub3RlQXR0YWNobWVudHMgPSBbXTsKICAgICAgdGhpcy5hdHRhY2htZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgdmFyIGF0dCA9IGEuYXR0YWNobWVudF9uYW1lLmRhdGEubWFwKGZ1bmN0aW9uIChiKSB7CiAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShiKTsKICAgICAgICB9KS5qb2luKCcnKTsKCiAgICAgICAgX3RoaXMubm90ZUF0dGFjaG1lbnRzLnB1c2goewogICAgICAgICAgYXR0YWNobWVudF9pZDogYS5hdHRhY2htZW50X2lkLAogICAgICAgICAgYXR0YWNobWVudF9uYW1lOiBhdHQsCiAgICAgICAgICBub3RlX2ZrOiBhLm5vdGVfZmsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgdmlld09uOiBmdW5jdGlvbiB2aWV3T24oYXR0YWNobWVudCkgewogICAgICB0aGlzLnZpZXdJbWFnZSA9IHRydWU7CiAgICAgIHRoaXMuc2VsZWN0ZWRBdHRhY2htZW50ID0gYXR0YWNobWVudDsKICAgIH0sCiAgICBiYWNrX25vdGVJbWFnZTogZnVuY3Rpb24gYmFja19ub3RlSW1hZ2UoKSB7CiAgICAgIHRoaXMudmlld0ltYWdlID0gZmFsc2U7CiAgICB9LAogICAgZGVsZXRlQXR0YWNobWVudDogZnVuY3Rpb24gZGVsZXRlQXR0YWNobWVudChhdHRhY2htZW50X2lkLCBub3RlX2ZrKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHNlc3Npb25faWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2Vzc2lvbl9pZCcpOwogICAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgICByZXF1ZXN0Lm9wZW4oJ0RFTEVURScsICdodHRwOi8vbG9jYWxob3N0OjgwODAvYXBpL2F0dGFjaG1lbnQnKTsKICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCdzZXNzaW9uX2lkJywgc2Vzc2lvbl9pZCk7CiAgICAgIHZhciBkYXRhID0gSlNPTi5zdHJpbmdpZnkoewogICAgICAgIGF0dGFjaG1lbnRfaWQ6IGF0dGFjaG1lbnRfaWQsCiAgICAgICAgbm90ZV9mazogbm90ZV9mawogICAgICB9KTsKICAgICAgcmVxdWVzdC5zZW5kKGRhdGEpOwoKICAgICAgcmVxdWVzdC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgLy9yZXF1ZXN0IGlzIHZhbGlkICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgIHZhciBuZXdBdHRhY2htZW50cyA9IFtdOwogICAgICAgICAgc2VsZi5ub3RlQXR0YWNobWVudHMuZm9yRWFjaChmdW5jdGlvbiAoYSkgewogICAgICAgICAgICBpZiAoYS5hdHRhY2htZW50X2lkICE9IGF0dGFjaG1lbnRfaWQpIHsKICAgICAgICAgICAgICBuZXdBdHRhY2htZW50cy5wdXNoKHsKICAgICAgICAgICAgICAgIGF0dGFjaG1lbnRfaWQ6IGEuYXR0YWNobWVudF9pZCwKICAgICAgICAgICAgICAgIGF0dGFjaG1lbnRfbmFtZTogYS5hdHRhY2htZW50X25hbWUsCiAgICAgICAgICAgICAgICBub3RlX2ZrOiBhLm5vdGVfZmsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBzZWxmLm5vdGVBdHRhY2htZW50cyA9IG5ld0F0dGFjaG1lbnRzOwogICAgICAgICAgYWxlcnQodGhpcy5yZXNwb25zZVRleHQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhbGVydCh0aGlzLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgfQogICAgICB9OwogICAgfSwKICAgIG9wZW5GaWxlOiBmdW5jdGlvbiBvcGVuRmlsZSgpIHsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0X2ZpbGUnKS5jbGljaygpOwogICAgfSwKICAgIHZhbGlkYXRlOiBmdW5jdGlvbiB2YWxpZGF0ZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgYXR0YWNobWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dF9maWxlJykuZmlsZXNbMF07CiAgICAgIHZhciBzaXplID0gYXR0YWNobWVudC5zaXplOwoKICAgICAgdHJ5IHsKICAgICAgICBpZiAoc2l6ZSA+PSAxMDAwMDAwMCkgewogICAgICAgICAgdGhyb3cgJ1VwbG9hZGVkIGZpbGUgbXVzdCBub3QgZXhjZWVkIDEwTUInOwogICAgICAgIH0KCiAgICAgICAgdGhpcy50b3RhbFNpemUgPSB0aGlzLnRvdGFsU2l6ZSArIHNpemU7CgogICAgICAgIGlmICh0aGlzLnRvdGFsU2l6ZSA+IDMwMDAwMDAwKSB7CiAgICAgICAgICB0aHJvdyAnVG90YWwgc2l6ZSBmb3IgbmV3IGF0dGFjaG1lbnRzIG11c3Qgbm90IGV4Y2VlZCAzMCBNQi4gUGxlYXNlIGNob29zZSBhIHNtYWxsZXIgZmlsZSc7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5uZXdOb3RlQXR0YWNobWVudHMgIT0gJycpIHsKICAgICAgICAgIHRoaXMubmV3Tm90ZUF0dGFjaG1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgaWYgKGEuYXR0YWNobWVudF9uYW1lID09IGF0dGFjaG1lbnQubmFtZSkgewogICAgICAgICAgICAgIHRocm93ICdGaWxlIGFscmVhZHkgYXR0YWNoZWQnOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGF0dGFjaG1lbnQpOyAvL2FkZCBhdHRhY2htZW50IHRvIHRoZSBhdHRhY2htZW50cyBhcnJheQoKICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgLy9jaGVjayB0aGF0IG5ldyBhdHRhY2htZW50IGRvZXMgbm90IGFscmVhZHkgZXhpc3QgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgX3RoaXMyLm5vdGVBdHRhY2htZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgIGlmIChhLmF0dGFjaG1lbnRfbmFtZSA9PT0gcmVhZGVyLnJlc3VsdCkgewogICAgICAgICAgICAgIHRocm93ICdGaWxlIGFscmVhZHkgYXR0YWNoZWQnOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpczIubmV3Tm90ZUF0dGFjaG1lbnRzLnB1c2goewogICAgICAgICAgICBhdHRhY2htZW50X25hbWU6IGF0dGFjaG1lbnQubmFtZSwKICAgICAgICAgICAgYXR0YWNobWVudF9kYXRhOiByZWFkZXIucmVzdWx0CiAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXdBdHRhY2htZW50c0NvbnRhaW5lcicpLnNjcm9sbFRvcCA9IDMwMDsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdEb3NzaWVyJykuc2Nyb2xsVG9wID0gMzAwOwogICAgICAgIH0sIDEwMCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgYWxlcnQoZXJyb3IpOwogICAgICB9CiAgICB9LAogICAgcmVtb3ZlTmV3QXR0YWNobWVudDogZnVuY3Rpb24gcmVtb3ZlTmV3QXR0YWNobWVudChhdHRhY2htZW50KSB7CiAgICAgIHZhciBuZXdBdHRhY2htZW50cyA9IFtdOwogICAgICB0aGlzLm5ld05vdGVBdHRhY2htZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgaWYgKGEuYXR0YWNobWVudF9uYW1lICE9IGF0dGFjaG1lbnQuYXR0YWNobWVudF9uYW1lKSB7CiAgICAgICAgICBuZXdBdHRhY2htZW50cy5wdXNoKGEpOwogICAgICAgIH0KICAgICAgfSk7IC8vIHRoaXMubmV3Tm90ZUF0dGFjaG1lbnRzPW5ld0F0dGFjaG1lbnRzOwoKICAgICAgdGhpcy5uZXdOb3RlQXR0YWNobWVudHMgPSBuZXdBdHRhY2htZW50czsKICAgIH0sCiAgICB1cGRhdGVBdHRhY2htZW50czogZnVuY3Rpb24gdXBkYXRlQXR0YWNobWVudHMoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIG5vdGVfZmsgPSB0aGlzLm5vdGVEYXRhWzBdLm5vdGVfaWQ7CiAgICAgIHZhciBzZXNzaW9uX2lkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Nlc3Npb25faWQnKTsKICAgICAgdmFyIGRhdGEgPSBbXTsKICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgcmVxdWVzdC5vcGVuKCdQT1NUJywgJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvYXR0YWNobWVudCcpOwogICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoJ3Nlc3Npb25faWQnLCBzZXNzaW9uX2lkKTsKICAgICAgY29uc29sZS5sb2codGhpcy5uZXdOb3RlQXR0YWNobWVudHMpOwogICAgICB0aGlzLm5ld05vdGVBdHRhY2htZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgZGF0YS5wdXNoKHsKICAgICAgICAgIGF0dGFjaG1lbnRfbmFtZTogYS5hdHRhY2htZW50X2RhdGEsCiAgICAgICAgICBub3RlX2ZrOiBub3RlX2ZrCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICBkYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7CiAgICAgIHJlcXVlc3Quc2VuZChkYXRhKTsKCiAgICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgIC8vcmVxdWVzdCBpcyB2YWxpZAogICAgICAgICAgYWxlcnQodGhpcy5yZXNwb25zZVRleHQpOyAvLyBjbGVhciBuZXdOb3RlQXR0YWNobWVudHMKCiAgICAgICAgICBzZWxmLm5ld05vdGVBdHRhY2htZW50cyA9IFtdOwogICAgICAgICAgc2VsZi4kZW1pdCgnZ2V0QXR0YWNobWVudHMnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWxlcnQodGhpcy5yZXNwb25zZVRleHQpOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["EditAttachments.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\n    <div id=\"EditAttachments\" class=\"container\">\n\n        <transition name=\"fade\">\n            <div v-if=\"!viewImage\">\n                <div class=\"row\">\n                    <button v-on:click='$emit(\"back_noteAttachments\")'>\n                        <i class=\"fas fa-caret-left back\"></i>\n                    </button>\n                </div>\n        \n                 <div class=\"container\">\n                    <h5 class=\"row darkcyan\">Edit or delete note attachments</h5>\n                </div>\n        \n                <div class=\"container sideDataContainer\">                \n                    <div class=\"row  top1 record justify_centre padding1\" v-for=\"noteAttachment in this.noteAttachments\" :key=\"noteAttachment\">   \n                        <div v-on:click='viewOn(noteAttachment.attachment_name)' ><img class=\"attachment\" v-bind:src='noteAttachment.attachment_name'></div>\n                        <a class=\"left2\" download v-bind:href='noteAttachment.attachment_name'>\n                            <button class=\"vertical_centre\" style=\"height:80px;\" >\n                                <i class=\"fas fa-download\"></i>\n                            </button>\n                        </a>\n                        <button class=\"left2 vertical_centre\" style=\"height:80px;\" v-on:click='deleteAttachment(noteAttachment.attachment_id,noteAttachment.note_fk)'>\n                            <i class=\"far fa-trash-alt\"></i\n                        ></button>                                \n                    </div>   \n                    <div class=\"row\" v-if=\"this.noteAttachments=='' &&!this.noAttachments\">\n                        <div class=\"row\" ><img style=\"height:40px;width:auto;\" class=\"col\" src=\"../assets/loading.gif\" alt=\"loading\"> </div>             \n                    </div>\n                </div>\n        \n                <div class=\"container top1\" id=\"newAttachmentsContainer\" style=\"height:auto; max-height: 300px; overflow-y: scroll;\">\n                    <div class=\"row\" v-for=\"newNoteAttachment in newNoteAttachments\" :key=\"newNoteAttachment.attachment_name\">\n                        \n                        <div><img class=\"attachment\" v-bind:src='newNoteAttachment.attachment_data'></div>\n                        \n                        <button style=\"height:80px\" class=\"left1 vertical-centre\" v-on:click='removeNewAttachment(newNoteAttachment)'><i class=\"far fa-times-circle black\"></i></button>\n                    </div>\n                </div>\n                <div class=\"container\">\n                    <div class=\"row\">\n                        <button v-on:click='openFile'><i class=\"fas fa-plus-circle\"></i></button>     \n                        <button v-if=\"this.newNoteAttachments!=''\" class=\"left1\" v-on:click='updateAttachments'>save</button>\n                    </div>        \n                </div>    \n        \n                <div class=\"container\" style=\"display:none\"> <input type=\"file\" id=\"input_file\" v-on:change='validate' accept=\".png,.jpeg,.jpg,.pdf\"> </div>\n            </div>  \n        </transition>\n\n        <transition name=\"down\"  >\n            <ViewImage\n             v-if=\"viewImage\"\n             v-on:back_noteImage='back_noteImage'\n             v-bind:attachments='selectedAttachment' \n             />\n        </transition >    \n    </div>  \n</template>\n\n\n<script>\n\nimport ViewImage from './ViewImage';\n\nexport default {\n    name:'EditAttachments',\n\n    components:{\n        ViewImage\n    },\n\n    data:function(){\n        return{\n           noteAttachments:[],\n\n           newNoteAttachments:[],\n           totalSize:0,\n           viewImage:false,\n           selectedAttachment:[]\n        }\n    },\n\n    props:['attachments','noteData','noAttachments'],\n\n    \n\n    watch:{\n         noteAttachments:function(newVal){\n\n               this.noteAttachments=newVal;                                \n               \n         }, \n\n         newNoteAttachments:function(newVal){\n\n               this.newNoteAttachments=newVal;                                \n               \n         },\n         attachments:function(newVal){\n\n               this.attachments=newVal;   \n               \n               this.showAttachments();\n               \n         },\n\n    },\n\n    mounted:function(){\n        \n        this.showAttachments();\n\n    },\n\n\n    methods:{\n\n        showAttachments:function(){\n\n            //turn attachment data into visible format\n            this.noteAttachments=[];\n            this.attachments.forEach(a => {\n            let att=a.attachment_name.data.map(b => String.fromCharCode(b)).join('');\n            this.noteAttachments.push({attachment_id:a.attachment_id,attachment_name:att,note_fk:a.note_fk});\n            \n            });\n\n        },\n\n        viewOn:function(attachment){\n            this.viewImage=true;\n            \n            this.selectedAttachment=attachment;\n            \n        },\n        back_noteImage:function(){\n            this.viewImage=false;\n        },\n\n        deleteAttachment:function(attachment_id,note_fk){\n            let self=this;\n            let session_id=localStorage.getItem('session_id');\n            let request=new XMLHttpRequest();                        \n            request.open('DELETE','http://localhost:8080/api/attachment');\n\n            request.setRequestHeader('session_id', session_id);\n            let data=JSON.stringify({attachment_id:attachment_id,note_fk:note_fk});\n\n            request.send(data);                  \n\n            request.onload = function (){        \n\n                    if(this.status==200){ //request is valid                    \n                        \n                        let newAttachments=[];\n                        self.noteAttachments.forEach(a=>{\n                            if(a.attachment_id!=attachment_id){                                \n                                newAttachments.push({attachment_id:a.attachment_id,\n                                                     attachment_name:a.attachment_name,\n                                                     note_fk:a.note_fk});\n                                }\n                         });\n                        \n                        self.noteAttachments=newAttachments;                                       \n                        alert(this.responseText);\n                    \n                    }\n                    else{\n                        alert(this.responseText);\n                    }                    \n            };\n        },\n\n        openFile:function(){\n            document.getElementById('input_file').click();\n        },\n\n        validate:function(){\n         \n            \n            let attachment=document.getElementById('input_file').files[0];\n\n            let size=attachment.size;\n\n            try{\n                if(size>=10000000){\n                        \n                        throw 'Uploaded file must not exceed 10MB';\n                }\n\n                this.totalSize=this.totalSize+size;     \n                \n                if(this.totalSize>30000000){\n                    throw 'Total size for new attachments must not exceed 30 MB. Please choose a smaller file';\n                }\n\n                if(this.newNoteAttachments!=''){\n\n                    this.newNoteAttachments.forEach(a => {                                \n                        if(a.attachment_name==attachment.name){                        \n                            throw 'File already attached';                            \n                        }                \n                    });                \n                }                                \n                let reader = new FileReader();\n                reader.readAsDataURL(attachment);\n\n                \n\n                //add attachment to the attachments array\n                reader.onload=()=>{                       \n                    //check that new attachment does not already exist                    \n                        this.noteAttachments.forEach(a => {                           \n                     if(a.attachment_name===reader.result){                            \n                        throw 'File already attached'; \n                     }                \n                    });                                \n                    this.newNoteAttachments.push({attachment_name:attachment.name,attachment_data:reader.result});                \n                }\n\n                setTimeout(() => {                \n                document.getElementById('newAttachmentsContainer').scrollTop=300;\n                document.getElementById('Dossier').scrollTop=300;\n                }, 100);\n                               \n            }\n            catch(error){\n                alert (error);\n            }\n\n\n\n        },\n\n        removeNewAttachment:function(attachment){\n            \n            let newAttachments=[];\n            this.newNoteAttachments.forEach(a=>{\n                if(a.attachment_name!=attachment.attachment_name){\n                    newAttachments.push(a);\n                }\n            });            \n            // this.newNoteAttachments=newAttachments;\n            this.newNoteAttachments=newAttachments;  \n        },\n\n        updateAttachments:function(){\n            let self=this;\n\n            let note_fk=this.noteData[0].note_id;            \n            let session_id=localStorage.getItem('session_id');\n            let data=[];\n            let request=new XMLHttpRequest();\n                            \n            request.open('POST','http://localhost:8080/api/attachment');\n\n            request.setRequestHeader('session_id', session_id);\n            console.log(this.newNoteAttachments);\n            this.newNoteAttachments.forEach(a=>{\n                data.push({attachment_name:a.attachment_data,note_fk:note_fk});\n            })\n\n           data=JSON.stringify(data);  \n           \n\n            request.send(data);                  \n\n            request.onload = function (){                                                                \n                if(this.status==200){ //request is valid\n\n                    alert(this.responseText); \n\n                    // clear newNoteAttachments\n                    self.newNoteAttachments=[];\n\n                    self.$emit('getAttachments');\n\n                }\n                else{\n                    alert(this.responseText);\n                }                    \n            };\n        }\n\n\n\n    \n\n    },\n}\n</script>\n\n\n<style>\n\n   \n   \n\n</style>\n\n"],"sourceRoot":"src/components"}]}