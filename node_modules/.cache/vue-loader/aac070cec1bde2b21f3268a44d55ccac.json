{"remainingRequest":"/Users/stavros/Documents/web/diary/scripta/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/stavros/Documents/web/diary/scripta/src/components/EditAttachments.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/stavros/Documents/web/diary/scripta/src/components/EditAttachments.vue","mtime":1614357400000},{"path":"/Users/stavros/Documents/web/diary/scripta/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/stavros/Documents/web/diary/scripta/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/stavros/Documents/web/diary/scripta/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/stavros/Documents/web/diary/scripta/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/stavros/Documents/web/diary/scripta/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgVmlld0ltYWdlIGZyb20gJy4vVmlld0ltYWdlJzsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6J0VkaXRBdHRhY2htZW50cycsCgogICAgY29tcG9uZW50czp7CiAgICAgICAgVmlld0ltYWdlCiAgICB9LAoKICAgIGRhdGE6ZnVuY3Rpb24oKXsKICAgICAgICByZXR1cm57CiAgICAgICAgICAgbm90ZUF0dGFjaG1lbnRzOltdLAoKICAgICAgICAgICBuZXdOb3RlQXR0YWNobWVudHM6W10sCiAgICAgICAgICAgdG90YWxTaXplOjAsCiAgICAgICAgICAgdmlld0ltYWdlOmZhbHNlLAogICAgICAgICAgIHNlbGVjdGVkQXR0YWNobWVudDpbXQogICAgICAgIH0KICAgIH0sCgogICAgcHJvcHM6WydhdHRhY2htZW50cycsJ25vdGVEYXRhJywnbm9BdHRhY2htZW50cyddLAoKICAgIAoKICAgIHdhdGNoOnsKICAgICAgICAgbm90ZUF0dGFjaG1lbnRzOmZ1bmN0aW9uKG5ld1ZhbCl7CgogICAgICAgICAgICAgICB0aGlzLm5vdGVBdHRhY2htZW50cz1uZXdWYWw7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgCiAgICAgICAgIH0sIAoKICAgICAgICAgbmV3Tm90ZUF0dGFjaG1lbnRzOmZ1bmN0aW9uKG5ld1ZhbCl7CgogICAgICAgICAgICAgICB0aGlzLm5ld05vdGVBdHRhY2htZW50cz1uZXdWYWw7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgCiAgICAgICAgIH0sCiAgICAgICAgIGF0dGFjaG1lbnRzOmZ1bmN0aW9uKG5ld1ZhbCl7CgogICAgICAgICAgICAgICB0aGlzLmF0dGFjaG1lbnRzPW5ld1ZhbDsgICAKICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgIHRoaXMuc2hvd0F0dGFjaG1lbnRzKCk7CiAgICAgICAgICAgICAgIAogICAgICAgICB9LAoKICAgIH0sCgogICAgbW91bnRlZDpmdW5jdGlvbigpewogICAgICAgIAogICAgICAgIHRoaXMuc2hvd0F0dGFjaG1lbnRzKCk7CgogICAgfSwKCgogICAgbWV0aG9kczp7CgogICAgICAgIHNob3dBdHRhY2htZW50czpmdW5jdGlvbigpewoKICAgICAgICAgICAgLy90dXJuIGF0dGFjaG1lbnQgZGF0YSBpbnRvIHZpc2libGUgZm9ybWF0CiAgICAgICAgICAgIHRoaXMubm90ZUF0dGFjaG1lbnRzPVtdOwogICAgICAgICAgICB0aGlzLmF0dGFjaG1lbnRzLmZvckVhY2goYSA9PiB7CiAgICAgICAgICAgIGxldCBhdHQ9YS5hdHRhY2htZW50X25hbWUuZGF0YS5tYXAoYiA9PiBTdHJpbmcuZnJvbUNoYXJDb2RlKGIpKS5qb2luKCcnKTsKICAgICAgICAgICAgdGhpcy5ub3RlQXR0YWNobWVudHMucHVzaCh7YXR0YWNobWVudF9pZDphLmF0dGFjaG1lbnRfaWQsYXR0YWNobWVudF9uYW1lOmF0dCxub3RlX2ZrOmEubm90ZV9ma30pOwogICAgICAgICAgICAKICAgICAgICAgICAgfSk7CgogICAgICAgIH0sCgogICAgICAgIHZpZXdPbjpmdW5jdGlvbihhdHRhY2htZW50KXsKICAgICAgICAgICAgdGhpcy52aWV3SW1hZ2U9dHJ1ZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRBdHRhY2htZW50PWF0dGFjaG1lbnQ7CiAgICAgICAgICAgIAogICAgICAgIH0sCiAgICAgICAgYmFja19ub3RlSW1hZ2U6ZnVuY3Rpb24oKXsKICAgICAgICAgICAgdGhpcy52aWV3SW1hZ2U9ZmFsc2U7CiAgICAgICAgfSwKCiAgICAgICAgZGVsZXRlQXR0YWNobWVudDpmdW5jdGlvbihhdHRhY2htZW50X2lkLG5vdGVfZmspewogICAgICAgICAgICBsZXQgc2VsZj10aGlzOwogICAgICAgICAgICBsZXQgc2Vzc2lvbl9pZD1sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2Vzc2lvbl9pZCcpOwogICAgICAgICAgICBsZXQgcmVxdWVzdD1uZXcgWE1MSHR0cFJlcXVlc3QoKTsgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgcmVxdWVzdC5vcGVuKCdERUxFVEUnLCdodHRwOi8vbG9jYWxob3N0OjgwODAvYXBpL2F0dGFjaG1lbnQnKTsKCiAgICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcignc2Vzc2lvbl9pZCcsIHNlc3Npb25faWQpOwogICAgICAgICAgICBsZXQgZGF0YT1KU09OLnN0cmluZ2lmeSh7YXR0YWNobWVudF9pZDphdHRhY2htZW50X2lkLG5vdGVfZms6bm90ZV9ma30pOwoKICAgICAgICAgICAgcmVxdWVzdC5zZW5kKGRhdGEpOyAgICAgICAgICAgICAgICAgIAoKICAgICAgICAgICAgcmVxdWVzdC5vbmxvYWQgPSBmdW5jdGlvbiAoKXsgICAgICAgIAoKICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnN0YXR1cz09MjAwKXsgLy9yZXF1ZXN0IGlzIHZhbGlkICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXdBdHRhY2htZW50cz1bXTsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ub3RlQXR0YWNobWVudHMuZm9yRWFjaChhPT57CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhLmF0dGFjaG1lbnRfaWQhPWF0dGFjaG1lbnRfaWQpeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3QXR0YWNobWVudHMucHVzaCh7YXR0YWNobWVudF9pZDphLmF0dGFjaG1lbnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNobWVudF9uYW1lOmEuYXR0YWNobWVudF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGVfZms6YS5ub3RlX2ZrfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm5vdGVBdHRhY2htZW50cz1uZXdBdHRhY2htZW50czsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQodGhpcy5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBhbGVydCh0aGlzLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH07CiAgICAgICAgfSwKCiAgICAgICAgb3BlbkZpbGU6ZnVuY3Rpb24oKXsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0X2ZpbGUnKS5jbGljaygpOwogICAgICAgIH0sCgogICAgICAgIHZhbGlkYXRlOmZ1bmN0aW9uKCl7CiAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IGF0dGFjaG1lbnQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0X2ZpbGUnKS5maWxlc1swXTsKCiAgICAgICAgICAgIGxldCBzaXplPWF0dGFjaG1lbnQuc2l6ZTsKCiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIGlmKHNpemU+PTEwMDAwMDAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93ICdVcGxvYWRlZCBmaWxlIG11c3Qgbm90IGV4Y2VlZCAxME1CJzsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsU2l6ZT10aGlzLnRvdGFsU2l6ZStzaXplOyAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmKHRoaXMudG90YWxTaXplPjMwMDAwMDAwKXsKICAgICAgICAgICAgICAgICAgICB0aHJvdyAnVG90YWwgc2l6ZSBmb3IgbmV3IGF0dGFjaG1lbnRzIG11c3Qgbm90IGV4Y2VlZCAzMCBNQi4gUGxlYXNlIGNob29zZSBhIHNtYWxsZXIgZmlsZSc7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYodGhpcy5uZXdOb3RlQXR0YWNobWVudHMhPScnKXsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdOb3RlQXR0YWNobWVudHMuZm9yRWFjaChhID0+IHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBpZihhLmF0dGFjaG1lbnRfbmFtZT09YXR0YWNobWVudC5uYW1lKXsgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93ICdGaWxlIGFscmVhZHkgYXR0YWNoZWQnOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB9KTsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoYXR0YWNobWVudCk7CgogICAgICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgLy9hZGQgYXR0YWNobWVudCB0byB0aGUgYXR0YWNobWVudHMgYXJyYXkKICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQ9KCk9PnsgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vY2hlY2sgdGhhdCBuZXcgYXR0YWNobWVudCBkb2VzIG5vdCBhbHJlYWR5IGV4aXN0ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RlQXR0YWNobWVudHMuZm9yRWFjaChhID0+IHsgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgaWYoYS5hdHRhY2htZW50X25hbWU9PT1yZWFkZXIucmVzdWx0KXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93ICdGaWxlIGFscmVhZHkgYXR0YWNoZWQnOyAKICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB9KTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHRoaXMubmV3Tm90ZUF0dGFjaG1lbnRzLnB1c2goe2F0dGFjaG1lbnRfbmFtZTphdHRhY2htZW50Lm5hbWUsYXR0YWNobWVudF9kYXRhOnJlYWRlci5yZXN1bHR9KTsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ld0F0dGFjaG1lbnRzQ29udGFpbmVyJykuc2Nyb2xsVG9wPTMwMDsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdEb3NzaWVyJykuc2Nyb2xsVG9wPTMwMDsKICAgICAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnJvcil7CiAgICAgICAgICAgICAgICBhbGVydCAoZXJyb3IpOwogICAgICAgICAgICB9CgoKCiAgICAgICAgfSwKCiAgICAgICAgcmVtb3ZlTmV3QXR0YWNobWVudDpmdW5jdGlvbihhdHRhY2htZW50KXsKICAgICAgICAgICAgCiAgICAgICAgICAgIGxldCBuZXdBdHRhY2htZW50cz1bXTsKICAgICAgICAgICAgdGhpcy5uZXdOb3RlQXR0YWNobWVudHMuZm9yRWFjaChhPT57CiAgICAgICAgICAgICAgICBpZihhLmF0dGFjaG1lbnRfbmFtZSE9YXR0YWNobWVudC5hdHRhY2htZW50X25hbWUpewogICAgICAgICAgICAgICAgICAgIG5ld0F0dGFjaG1lbnRzLnB1c2goYSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOyAgICAgICAgICAgIAogICAgICAgICAgICAvLyB0aGlzLm5ld05vdGVBdHRhY2htZW50cz1uZXdBdHRhY2htZW50czsKICAgICAgICAgICAgdGhpcy5uZXdOb3RlQXR0YWNobWVudHM9bmV3QXR0YWNobWVudHM7ICAKICAgICAgICB9LAoKICAgICAgICB1cGRhdGVBdHRhY2htZW50czpmdW5jdGlvbigpewogICAgICAgICAgICBsZXQgc2VsZj10aGlzOwoKICAgICAgICAgICAgbGV0IG5vdGVfZms9dGhpcy5ub3RlRGF0YVswXS5ub3RlX2lkOyAgICAgICAgICAgIAogICAgICAgICAgICBsZXQgc2Vzc2lvbl9pZD1sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2Vzc2lvbl9pZCcpOwogICAgICAgICAgICBsZXQgZGF0YT1bXTsKICAgICAgICAgICAgbGV0IHJlcXVlc3Q9bmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgcmVxdWVzdC5vcGVuKCdQT1NUJywnaHR0cDovL2xvY2FsaG9zdDo4MDgwL2FwaS9hdHRhY2htZW50Jyk7CgogICAgICAgICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoJ3Nlc3Npb25faWQnLCBzZXNzaW9uX2lkKTsKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5uZXdOb3RlQXR0YWNobWVudHMpOwogICAgICAgICAgICB0aGlzLm5ld05vdGVBdHRhY2htZW50cy5mb3JFYWNoKGE9PnsKICAgICAgICAgICAgICAgIGRhdGEucHVzaCh7YXR0YWNobWVudF9uYW1lOmEuYXR0YWNobWVudF9kYXRhLG5vdGVfZms6bm90ZV9ma30pOwogICAgICAgICAgICB9KQoKICAgICAgICAgICBkYXRhPUpTT04uc3RyaW5naWZ5KGRhdGEpOyAgCiAgICAgICAgICAgCgogICAgICAgICAgICByZXF1ZXN0LnNlbmQoZGF0YSk7ICAgICAgICAgICAgICAgICAgCgogICAgICAgICAgICByZXF1ZXN0Lm9ubG9hZCA9IGZ1bmN0aW9uICgpeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmKHRoaXMuc3RhdHVzPT0yMDApeyAvL3JlcXVlc3QgaXMgdmFsaWQKCiAgICAgICAgICAgICAgICAgICAgYWxlcnQodGhpcy5yZXNwb25zZVRleHQpOyAKCiAgICAgICAgICAgICAgICAgICAgLy8gY2xlYXIgbmV3Tm90ZUF0dGFjaG1lbnRzCiAgICAgICAgICAgICAgICAgICAgc2VsZi5uZXdOb3RlQXR0YWNobWVudHM9W107CgogICAgICAgICAgICAgICAgICAgIHNlbGYuJGVtaXQoJ2dldEF0dGFjaG1lbnRzJyk7CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBhbGVydCh0aGlzLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfTsKICAgICAgICB9CgoKCiAgICAKCiAgICB9LAp9Cg=="},{"version":3,"sources":["EditAttachments.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;AAIA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA","file":"EditAttachments.vue","sourceRoot":"src/components","sourcesContent":["<template>\n\n    <div id=\"EditAttachments\" class=\"container\">\n\n        <transition name=\"fade\">\n            <div v-if=\"!viewImage\">\n                <div class=\"row\">\n                    <button v-on:click='$emit(\"back_noteAttachments\")'>\n                        <i class=\"fas fa-caret-left back\"></i>\n                    </button>\n                </div>\n        \n                 <div class=\"container\">\n                    <h5 class=\"row darkcyan\">Edit or delete note attachments</h5>\n                </div>\n        \n                <div class=\"container sideDataContainer\">                \n                    <div class=\"row  top1 record justify_centre padding1\" v-for=\"noteAttachment in this.noteAttachments\" :key=\"noteAttachment\">   \n                        <div v-on:click='viewOn(noteAttachment.attachment_name)' ><img class=\"attachment\" v-bind:src='noteAttachment.attachment_name'></div>\n                        <a class=\"left2\" download v-bind:href='noteAttachment.attachment_name'>\n                            <button class=\"vertical_centre\" style=\"height:80px;\" >\n                                <i class=\"fas fa-download\"></i>\n                            </button>\n                        </a>\n                        <button class=\"left2 vertical_centre\" style=\"height:80px;\" v-on:click='deleteAttachment(noteAttachment.attachment_id,noteAttachment.note_fk)'>\n                            <i class=\"far fa-trash-alt\"></i\n                        ></button>                                \n                    </div>   \n                    <div class=\"row\" v-if=\"this.noteAttachments=='' &&!this.noAttachments\">\n                        <div class=\"row\" ><img style=\"height:40px;width:auto;\" class=\"col\" src=\"../assets/loading.gif\" alt=\"loading\"> </div>             \n                    </div>\n                </div>\n        \n                <div class=\"container top1\" id=\"newAttachmentsContainer\" style=\"height:auto; max-height: 300px; overflow-y: scroll;\">\n                    <div class=\"row\" v-for=\"newNoteAttachment in newNoteAttachments\" :key=\"newNoteAttachment.attachment_name\">\n                        \n                        <div><img class=\"attachment\" v-bind:src='newNoteAttachment.attachment_data'></div>\n                        \n                        <button style=\"height:80px\" class=\"left1 vertical-centre\" v-on:click='removeNewAttachment(newNoteAttachment)'><i class=\"far fa-times-circle black\"></i></button>\n                    </div>\n                </div>\n                <div class=\"container\">\n                    <div class=\"row\">\n                        <button v-on:click='openFile'><i class=\"fas fa-plus-circle\"></i></button>     \n                        <button v-if=\"this.newNoteAttachments!=''\" class=\"left1\" v-on:click='updateAttachments'>save</button>\n                    </div>        \n                </div>    \n        \n                <div class=\"container\" style=\"display:none\"> <input type=\"file\" id=\"input_file\" v-on:change='validate' accept=\".png,.jpeg,.jpg,.pdf\"> </div>\n            </div>  \n        </transition>\n\n        <transition name=\"down\"  >\n            <ViewImage\n             v-if=\"viewImage\"\n             v-on:back_noteImage='back_noteImage'\n             v-bind:attachments='selectedAttachment' \n             />\n        </transition >    \n    </div>  \n</template>\n\n\n<script>\n\nimport ViewImage from './ViewImage';\n\nexport default {\n    name:'EditAttachments',\n\n    components:{\n        ViewImage\n    },\n\n    data:function(){\n        return{\n           noteAttachments:[],\n\n           newNoteAttachments:[],\n           totalSize:0,\n           viewImage:false,\n           selectedAttachment:[]\n        }\n    },\n\n    props:['attachments','noteData','noAttachments'],\n\n    \n\n    watch:{\n         noteAttachments:function(newVal){\n\n               this.noteAttachments=newVal;                                \n               \n         }, \n\n         newNoteAttachments:function(newVal){\n\n               this.newNoteAttachments=newVal;                                \n               \n         },\n         attachments:function(newVal){\n\n               this.attachments=newVal;   \n               \n               this.showAttachments();\n               \n         },\n\n    },\n\n    mounted:function(){\n        \n        this.showAttachments();\n\n    },\n\n\n    methods:{\n\n        showAttachments:function(){\n\n            //turn attachment data into visible format\n            this.noteAttachments=[];\n            this.attachments.forEach(a => {\n            let att=a.attachment_name.data.map(b => String.fromCharCode(b)).join('');\n            this.noteAttachments.push({attachment_id:a.attachment_id,attachment_name:att,note_fk:a.note_fk});\n            \n            });\n\n        },\n\n        viewOn:function(attachment){\n            this.viewImage=true;\n            \n            this.selectedAttachment=attachment;\n            \n        },\n        back_noteImage:function(){\n            this.viewImage=false;\n        },\n\n        deleteAttachment:function(attachment_id,note_fk){\n            let self=this;\n            let session_id=localStorage.getItem('session_id');\n            let request=new XMLHttpRequest();                        \n            request.open('DELETE','http://localhost:8080/api/attachment');\n\n            request.setRequestHeader('session_id', session_id);\n            let data=JSON.stringify({attachment_id:attachment_id,note_fk:note_fk});\n\n            request.send(data);                  \n\n            request.onload = function (){        \n\n                    if(this.status==200){ //request is valid                    \n                        \n                        let newAttachments=[];\n                        self.noteAttachments.forEach(a=>{\n                            if(a.attachment_id!=attachment_id){                                \n                                newAttachments.push({attachment_id:a.attachment_id,\n                                                     attachment_name:a.attachment_name,\n                                                     note_fk:a.note_fk});\n                                }\n                         });\n                        \n                        self.noteAttachments=newAttachments;                                       \n                        alert(this.responseText);\n                    \n                    }\n                    else{\n                        alert(this.responseText);\n                    }                    \n            };\n        },\n\n        openFile:function(){\n            document.getElementById('input_file').click();\n        },\n\n        validate:function(){\n         \n            \n            let attachment=document.getElementById('input_file').files[0];\n\n            let size=attachment.size;\n\n            try{\n                if(size>=10000000){\n                        \n                        throw 'Uploaded file must not exceed 10MB';\n                }\n\n                this.totalSize=this.totalSize+size;     \n                \n                if(this.totalSize>30000000){\n                    throw 'Total size for new attachments must not exceed 30 MB. Please choose a smaller file';\n                }\n\n                if(this.newNoteAttachments!=''){\n\n                    this.newNoteAttachments.forEach(a => {                                \n                        if(a.attachment_name==attachment.name){                        \n                            throw 'File already attached';                            \n                        }                \n                    });                \n                }                                \n                let reader = new FileReader();\n                reader.readAsDataURL(attachment);\n\n                \n\n                //add attachment to the attachments array\n                reader.onload=()=>{                       \n                    //check that new attachment does not already exist                    \n                        this.noteAttachments.forEach(a => {                           \n                     if(a.attachment_name===reader.result){                            \n                        throw 'File already attached'; \n                     }                \n                    });                                \n                    this.newNoteAttachments.push({attachment_name:attachment.name,attachment_data:reader.result});                \n                }\n\n                setTimeout(() => {                \n                document.getElementById('newAttachmentsContainer').scrollTop=300;\n                document.getElementById('Dossier').scrollTop=300;\n                }, 100);\n                               \n            }\n            catch(error){\n                alert (error);\n            }\n\n\n\n        },\n\n        removeNewAttachment:function(attachment){\n            \n            let newAttachments=[];\n            this.newNoteAttachments.forEach(a=>{\n                if(a.attachment_name!=attachment.attachment_name){\n                    newAttachments.push(a);\n                }\n            });            \n            // this.newNoteAttachments=newAttachments;\n            this.newNoteAttachments=newAttachments;  \n        },\n\n        updateAttachments:function(){\n            let self=this;\n\n            let note_fk=this.noteData[0].note_id;            \n            let session_id=localStorage.getItem('session_id');\n            let data=[];\n            let request=new XMLHttpRequest();\n                            \n            request.open('POST','http://localhost:8080/api/attachment');\n\n            request.setRequestHeader('session_id', session_id);\n            console.log(this.newNoteAttachments);\n            this.newNoteAttachments.forEach(a=>{\n                data.push({attachment_name:a.attachment_data,note_fk:note_fk});\n            })\n\n           data=JSON.stringify(data);  \n           \n\n            request.send(data);                  \n\n            request.onload = function (){                                                                \n                if(this.status==200){ //request is valid\n\n                    alert(this.responseText); \n\n                    // clear newNoteAttachments\n                    self.newNoteAttachments=[];\n\n                    self.$emit('getAttachments');\n\n                }\n                else{\n                    alert(this.responseText);\n                }                    \n            };\n        }\n\n\n\n    \n\n    },\n}\n</script>\n\n\n<style>\n\n   \n   \n\n</style>\n\n"]}]}